{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/until.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parse.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["import { observer } from \".\"\r\n\r\n// 拿到数组原型上的方法\r\nlet oldArrayProtoMethods = Array.prototype\r\n\r\n// 继承 arrayMrthods.__proto__ = oldArrayProtoMethods\r\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\r\n\r\nlet methods = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'reserve',\r\n  'sort',\r\n  'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[method] = function (...arg) {\r\n    const result = oldArrayProtoMethods[method].apply(this, arg)  // ?\r\n    let inserted\r\n    let ob = this.__ob__\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift': // 都是追加，需要继续检测\r\n        inserted = arg\r\n        break;\r\n\r\n      case 'splice': //vue.$set原理\r\n        inserted = arg.slice(2)\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    if (inserted) ob.observerArray(inserted)\r\n\r\n    return result\r\n  }\r\n})\r\n","export function proxy(vm, data, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[data][key]\r\n    },\r\n    set(newValue) {\r\n      vm[data][key] = newValue\r\n    }\r\n  })\r\n}\r\n\r\nexport function defineProperty(target, key, value) {\r\n  Object.defineProperty(target, key, {\r\n    enumerable: false,\r\n    configurable: false,\r\n    value\r\n  })\r\n}","import { arrayMethods } from './array'\r\nimport { defineProperty } from '../until'\r\nclass Observer {\r\n  constructor(value) {\r\n\r\n    // 判断一个对象是否被观测过，看有没有__ob__\r\n    defineProperty(value, '__ob__', this)\r\n\r\n    // 使用defineProperty重新定义树形\r\n    if (Array.isArray(value)) {\r\n      //函数劫持、切片编程 \r\n      value.__proto__ = arrayMethods\r\n\r\n      // 观测数组中的对象类型，对象变化也要做处理\r\n      this.observerArray(value)\r\n    } else {\r\n      this.walk(value)\r\n    }\r\n  }\r\n\r\n  observerArray(value) {\r\n    value.forEach(item => {\r\n      observer(item)\r\n    })\r\n  }\r\n\r\n  walk(data) {\r\n    let keys = Object.keys(data) //获取对象的key\r\n    keys.forEach(key => {\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  observer(value) //如果值是对象，继续观测。对象套对象，递归检测\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      return value\r\n    },\r\n    set(newValue) {\r\n      if (newValue === value) return\r\n      observer(newValue) // 设置值是对象，继续观测\r\n      value = newValue\r\n    }\r\n  })\r\n}\r\n\r\nexport function observer(data) {\r\n  // 不是对象或者是null\r\n  if (typeof data !== 'object' || data === null) {\r\n    return data\r\n  }\r\n\r\n  if (data.__ob__) { // ？为什么可能被重复观测\r\n    return data\r\n  }\r\n  return new Observer(data)\r\n}","import { observer } from \"./observer/index\"\r\nimport { proxy } from './until'\r\nexport function initState(vm) {\r\n  const options = vm.$options\r\n\r\n  if (options.props) {\r\n    initProps(vm)\r\n  }\r\n\r\n  if (options.methods) {\r\n    initMethods(vm)\r\n  }\r\n\r\n  if (options.data) {\r\n    initData(vm)\r\n  }\r\n\r\n  if (options.computed) {\r\n    initComputed(vm)\r\n  }\r\n\r\n  if (options.watch) {\r\n    initWatch(vm)\r\n  }\r\n}\r\n\r\nfunction initProps() { }\r\nfunction initMethods() { }\r\n\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data\r\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data\r\n\r\n  // 去vm上取值，代理到_data上\r\n  for (const key in data) {\r\n    proxy(vm, '_data', key)\r\n  }\r\n\r\n\r\n  // 数据劫持，对象Object.defineProperty\r\n  observer(data)\r\n\r\n}\r\nfunction initComputed() { }\r\nfunction initWatch() { }","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nexport function parseHTML(html) {\r\n  function createASTElement(tagName, attrs) {\r\n    return {\r\n      tag: tagName,\r\n      type: 1,\r\n      children: [],\r\n      attrs,\r\n      parent: null\r\n    }\r\n  }\r\n\r\n  let root = null\r\n  let currentParent;\r\n  let stack = [];// 标签校验符合预期 <div><span></span></div> ['div','span']\r\n\r\n  function start(tagName, attrs) {\r\n    let element = createASTElement(tagName, attrs)\r\n    if (!root) {\r\n      root = element\r\n    }\r\n    currentParent = element\r\n    stack.push(element)\r\n  }\r\n\r\n  function end(tagName) {\r\n    let element = stack.pop() // 取最后一个\r\n    currentParent = stack[stack.length - 1]\r\n    if (currentParent) { //在闭合时知道这个标签的父亲，并设置他的儿子\r\n      // *利用进先进后出方式，设置父子级关联\r\n      element.parent = currentParent\r\n      currentParent.children.push(element)\r\n    }\r\n  }\r\n\r\n  function chars(text) {\r\n    text = text.trim()\r\n    if (text) {\r\n      currentParent.children.push({\r\n        type: 3,\r\n        text\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  while (html) { //html不为空一直解析\r\n    let textEnd = html.indexOf('<') // 标签开始结束都是<开头\r\n    if (textEnd === 0) {\r\n      const startTagMatch = parseStartTag() //开始标签匹配的结果\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        continue\r\n      }\r\n\r\n      const endTagMatch = html.match(endTag) //开始标签匹配的结果\r\n      if (endTagMatch) { // 处理结束标签\r\n        advance(endTagMatch[0].length)\r\n        end(endTagMatch[1])\r\n        continue\r\n      }\r\n    }\r\n\r\n    if (textEnd > 0) {\r\n      let text = html.substring(0, textEnd)\r\n      if (text) { // 处理文本\r\n        advance(text.length)\r\n        chars(text)\r\n      }\r\n    }\r\n\r\n  }\r\n  function advance(n) {  // 将字符串进行截取操作，更新html\r\n    html = html.substring(n)\r\n  }\r\n  function parseStartTag() {\r\n    const start = html.match(startTagOpen)\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[1],\r\n        attrs: []\r\n      }\r\n      advance(start[0].length) //删除开始标签\r\n\r\n      let end;\r\n      let attr;\r\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n        match.attrs.push({\r\n          name: attr[1],\r\n          value: attr[3] || attr[4] || attr[5]\r\n        })\r\n        advance(attr[0].length) //去掉当前属性\r\n      }\r\n\r\n      if (end) {\r\n        advance(end.length) //去掉标签结束符号\r\n        return match\r\n      }\r\n    }\r\n  }\r\n\r\n  return root\r\n}\r\n\r\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nfunction genProps(attrs) {\r\n  let str = ''\r\n  attrs.forEach(attr => {\r\n    if (attr.name === 'style') {\r\n      let obj = {}\r\n      attr.value.split(';').forEach(item => {\r\n        let [key, value] = item.split(':');\r\n        obj[key] = value\r\n      })\r\n      attr.value = obj\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n  });\r\n\r\n  return `{${str.slice(0, -1)}}`\r\n}\r\nfunction gen(node) {\r\n  if (node.type === 1) {\r\n    return generate(node)\r\n  } else if (node.type === 3) {\r\n    let text = node.text\r\n    if (!defaultTagRE.test(text)) {\r\n      return `_v(${JSON.stringify(text)})`\r\n    }\r\n\r\n    let tokens = []\r\n    let lastIndex = defaultTagRE.lastIndex = 0 //如果正则是全局模式，每次使用前设置为0\r\n    let match, index //每次匹配到的结果\r\n    while (match = defaultTagRE.exec(text)) {\r\n      index = match.index //保存匹配到的索引\r\n      if (index > lastIndex) {\r\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n      }\r\n      tokens.push(`_s(${match[1].trim()})`)\r\n      lastIndex = index + match[0].length\r\n    }\r\n\r\n    if (lastIndex < text.length) {\r\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n    }\r\n\r\n    return `_v(${tokens.join('+')})`\r\n  }\r\n}\r\nfunction genChildren(el) {\r\n  const { children } = el\r\n  if (children) {\r\n    return children.map(child => gen(child)).join(',')\r\n  }\r\n}\r\nexport function generate(el) {\r\n  let children = genChildren(el)\r\n  let code = `_c(${JSON.stringify(el.tag\r\n  )},${\r\n    el.attrs.length ? `${genProps(el.attrs)}` : 'undefined'\r\n    }${\r\n    children ? `,${children}` : ''\r\n    })`\r\n\r\n  return code\r\n}","import { parseHTML } from './parse'\r\nimport { generate } from './generate'\r\nexport function compileToFunctions(template) {\r\n  /* \r\n     1、html => sat语法树(用来描述语言本身)\r\n     \r\n\r\n     虚拟dom 用对象描述节点\r\n  */\r\n  let ast = parseHTML(template)\r\n\r\n  //2、 优化静态节点\r\n\r\n  //3、通过这树生成新代码\r\n  let code = generate(ast)\r\n\r\n  //4、将字符串转换成函数,通过with取值\r\n  let render = new Function(`with(this){return ${code}}`)\r\n\r\n  return render\r\n}","import { initState } from './state'\r\nimport { compileToFunctions } from './compiler/index'\r\nexport function initMixin(Vue) {\r\n\r\n  Vue.prototype._init = function (options) {\r\n\r\n    const vm = this\r\n    vm.$options = options\r\n\r\n    // 响应式数据原理\r\n\r\n    //初始化状态(data、props、watch、computed)，将数据初始化劫持，改变数据更新视图\r\n    initState(vm)\r\n\r\n    // Vue是个什么框架，借鉴MVVM\r\n    // MVVM:数据变化视图会更新，视图变化数据会被影响，不能替你跳过数据去更新视图\r\n    // ****要看下官网文档这块\r\n\r\n\r\n    // 如果有el树形说明要渲染模板\r\n    if (vm.$options.el) {\r\n      vm.$mount(vm.$options.el)\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    // 挂在操作\r\n    const vm = this\r\n    el = document.querySelector(el)\r\n    const options = vm.$options\r\n\r\n    if (!options.render) {\r\n      // 没render ，将template转成render\r\n      let template = options.template;\r\n      if (!template && el) {\r\n        template = el.outerHTML\r\n      }\r\n\r\n      // 编译原理，template转成render\r\n      const render = compileToFunctions(template)\r\n      options.render = render\r\n    }\r\n  }\r\n}","import { initMixin } from './init'\r\nfunction Vue(options) {\r\n  this._init(options); // 入口，初始化\r\n\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","arg","result","apply","inserted","ob","__ob__","slice","observerArray","proxy","vm","data","key","defineProperty","get","set","newValue","target","value","enumerable","configurable","Observer","isArray","__proto__","walk","item","observer","keys","defineReactive","initState","options","$options","props","initData","computed","watch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tagName","attrs","tag","type","children","parent","root","currentParent","stack","start","element","push","end","pop","length","chars","text","trim","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","obj","split","JSON","stringify","gen","node","generate","test","tokens","lastIndex","index","exec","join","genChildren","el","map","child","code","compileToFunctions","template","ast","render","Function","initMixin","Vue","_init","$mount","document","querySelector","outerHTML"],"mappings":"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"}